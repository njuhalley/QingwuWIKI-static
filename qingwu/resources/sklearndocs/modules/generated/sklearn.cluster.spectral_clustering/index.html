

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
  
    <title>sklearn.cluster.spectral_clustering &#8212; scikit-learn 0.19.1 documentation</title>
  <!-- htmltitle is before nature.css - we use this hack to load bootstrap first -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="../../../_static/css/bootstrap.min.css" media="screen" />
  <link rel="stylesheet" href="../../../_static/css/bootstrap-responsive.css"/>

    <link rel="stylesheet" href="../../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/gallery.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../../_static/js/copybutton.js"></script>
    <script type="text/javascript" src="../../../_static/js/extra.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_SVG"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../../about/" />
    <link rel="search" title="Search" href="../../../search/" />
    <link rel="next" title="sklearn.cluster.ward_tree" href="../sklearn.cluster.ward_tree/" />
    <link rel="prev" title="sklearn.cluster.mean_shift" href="../sklearn.cluster.mean_shift/" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="../../../_static/js/bootstrap.min.js" type="text/javascript"></script>
  <script>
     VERSION_SUBDIR = (function(groups) {
         return groups ? groups[1] : null;
     })(location.href.match(/^https?:\/\/scikit-learn.org\/([^\/]+)/));
  </script>
  <link rel="canonical" href="http://scikit-learn.org/stable/modules/generated/sklearn.cluster.spectral_clustering.html" />

  <script type="text/javascript">
    $("div.buttonNext, div.buttonPrevious").hover(
       function () {
           $(this).css('background-color', '#FF9C34');
       },
       function () {
           $(this).css('background-color', '#A7D6E2');
       }
    );
    function showMenu() {
      var topNav = document.getElementById("scikit-navbar");
      if (topNav.className === "navbar") {
          topNav.className += " responsive";
      } else {
          topNav.className = "navbar";
      }
    };
  </script>

  </head><body>

<div class="header-wrapper">
    <div class="header">
        <p class="logo"><a href="../../../">
            <img src="../../../_static/scikit-learn-logo-small.png" alt="Logo"/>
        </a>
        </p><div class="navbar" id="scikit-navbar">
            <ul>
                <li><a href="../../../">Home</a></li>
                <li><a href="../../../install/">Installation</a></li>
                <li class="btn-li"><div class="btn-group">
              <a href="../../../documentation/">Documentation</a>
              <a class="btn dropdown-toggle" data-toggle="dropdown">
                 <span class="caret"></span>
              </a>
              <ul class="dropdown-menu">
            <li class="link-title">Scikit-learn <script>document.write(DOCUMENTATION_OPTIONS.VERSION + (VERSION_SUBDIR ? " (" + VERSION_SUBDIR + ")" : ""));</script></li>
            <li><a href="../../../tutorial/">Tutorials</a></li>
            <li><a href="../../../user_guide/">User guide</a></li>
            <li><a href="../../classes/">API</a></li>
            <li><a href="../../../glossary/">Glossary</a></li>
            <li><a href="../../../faq/">FAQ</a></li>
            <li><a href="../../../developers/">Development</a></li>
            <li><a href="../../../roadmap/">Roadmap</a></li>
            <li class="divider"></li>
                <script>if (VERSION_SUBDIR != "stable") document.write('<li><a href="http://scikit-learn.org/stable/documentation.html">Stable version</a></li>')</script>
                <script>if (VERSION_SUBDIR != "dev") document.write('<li><a href="http://scikit-learn.org/dev/documentation.html">Development version</a></li>')</script>
                <li><a href="http://scikit-learn.org/dev/versions.html">All available versions</a></li>
                <li><a href="../../../_downloads/scikit-learn-docs.pdf">PDF documentation</a></li>
              </ul>
            </div>
        </li>
            <li><a href="../../../auto_examples/">Examples</a></li>
            </ul>
            <a href="javascript:void(0);" onclick="showMenu()">
                <div class="nav-icon">
                    <div class="hamburger-line"></div>
                    <div class="hamburger-line"></div>
                    <div class="hamburger-line"></div>
                </div>
            </a>
            <div class="search_form">
                <div class="gcse-search" id="cse" style="width: 100%;"></div>
            </div>
        </div> <!-- end navbar --></div>
</div>


<!-- GitHub "fork me" ribbon -->
<a href="https://github.com/scikit-learn/scikit-learn">
  <img class="fork-me"
       style="position: absolute; top: 0; right: 0; border: 0;"
       src="../../../_static/img/forkme.png"
       alt="Fork me on GitHub" />
</a>

<div class="content-wrapper">
    <div class="sphinxsidebar">
    <div class="sphinxsidebarwrapper">
        <div class="rel">
    
        <div class="rellink">
        <a href="../sklearn.cluster.mean_shift/"
        accesskey="P">Previous
        <br/>
        <span class="smallrellink">
        sklearn.clust...
        </span>
            <span class="hiddenrellink">
            sklearn.cluster.mean_shift
            </span>
        </a>
        </div>
            <div class="spacer">
            &nbsp;
            </div>
        <div class="rellink">
        <a href="../sklearn.cluster.ward_tree/"
        accesskey="N">Next
        <br/>
        <span class="smallrellink">
        sklearn.clust...
        </span>
            <span class="hiddenrellink">
            sklearn.cluster.ward_tree
            </span>
        </a>
        </div>

    <!-- Ad a link to the 'up' page -->
        <div class="spacer">
        &nbsp;
        </div>
        <div class="rellink">
        <a href="../../classes/">
        Up
        <br/>
        <span class="smallrellink">
        API Reference
        </span>
            <span class="hiddenrellink">
            API Reference
            </span>
            
        </a>
        </div>
    </div>
    
      <p class="doc-version"><b>scikit-learn v0.19.1</b><br/>
      <a href="http://scikit-learn.org/dev/versions.html">Other versions</a></p>
    <p class="citing">Please <b><a href="../../../about/#citing-scikit-learn" style="font-size: 110%;">cite us </a></b>if you use the software.</p>
    <ul>
<li><a class="reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sklearn.cluster</span></code>.spectral_clustering</a><ul>
<li><a class="reference internal" href="#examples-using-sklearn-cluster-spectral-clustering">Examples using <code class="docutils literal notranslate"><span class="pre">sklearn.cluster.spectral_clustering</span></code></a></li>
</ul>
</li>
</ul>

    </div>
</div>

<input type="checkbox" id="nav-trigger" class="nav-trigger" checked />
<label for="nav-trigger"></label>




      <div class="content">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="sklearn-cluster-spectral-clustering">
<h1><a class="reference internal" href="../../classes/#module-sklearn.cluster" title="sklearn.cluster"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sklearn.cluster</span></code></a>.spectral_clustering<a class="headerlink" href="#sklearn-cluster-spectral-clustering" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="sklearn.cluster.spectral_clustering">
<code class="descclassname">sklearn.cluster.</code><code class="descname">spectral_clustering</code><span class="sig-paren">(</span><em>affinity</em>, <em>n_clusters=8</em>, <em>n_components=None</em>, <em>eigen_solver=None</em>, <em>random_state=None</em>, <em>n_init=10</em>, <em>eigen_tol=0.0</em>, <em>assign_labels='kmeans'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/scikit-learn/scikit-learn/blob/8f35843/sklearn/cluster\spectral.py#L160"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sklearn.cluster.spectral_clustering" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply clustering to a projection to the normalized laplacian.</p>
<p>In practice Spectral Clustering is very useful when the structure of
the individual clusters is highly non-convex or more generally when
a measure of the center and spread of the cluster is not a suitable
description of the complete cluster. For instance when clusters are
nested circles on the 2D plan.</p>
<p>If affinity is the adjacency matrix of a graph, this method can be
used to find normalized graph cuts.</p>
<p>Read more in the <a class="reference internal" href="../../clustering/#spectral-clustering"><span class="std std-ref">User Guide</span></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>affinity</strong><span class="classifier">array-like or sparse matrix, shape: (n_samples, n_samples)</span></dt><dd><p>The affinity matrix describing the relationship of the samples to
embed. <strong>Must be symmetric</strong>.</p>
<dl class="simple">
<dt>Possible examples:</dt><dd><ul class="simple">
<li><p>adjacency matrix of a graph,</p></li>
<li><p>heat kernel of the pairwise distance matrix of the samples,</p></li>
<li><p>symmetric k-nearest neighbours connectivity matrix of the samples.</p></li>
</ul>
</dd>
</dl>
</dd>
<dt><strong>n_clusters</strong><span class="classifier">integer, optional</span></dt><dd><p>Number of clusters to extract.</p>
</dd>
<dt><strong>n_components</strong><span class="classifier">integer, optional, default is n_clusters</span></dt><dd><p>Number of eigen vectors to use for the spectral embedding</p>
</dd>
<dt><strong>eigen_solver</strong><span class="classifier">{None, ‘arpack’, ‘lobpcg’, or ‘amg’}</span></dt><dd><p>The eigenvalue decomposition strategy to use. AMG requires pyamg
to be installed. It can be faster on very large, sparse problems,
but may also lead to instabilities</p>
</dd>
<dt><strong>random_state</strong><span class="classifier">int, RandomState instance or None, optional, default: None</span></dt><dd><p>A pseudo random number generator used for the initialization of the
lobpcg eigen vectors decomposition when eigen_solver == ‘amg’ and by
the K-Means initialization. If int, random_state is the seed used by
the random number generator; If RandomState instance, random_state is
the random number generator; If None, the random number generator is
the RandomState instance used by <code class="docutils literal notranslate"><span class="pre">np.random</span></code>.</p>
</dd>
<dt><strong>n_init</strong><span class="classifier">int, optional, default: 10</span></dt><dd><p>Number of time the k-means algorithm will be run with different
centroid seeds. The final results will be the best output of
n_init consecutive runs in terms of inertia.</p>
</dd>
<dt><strong>eigen_tol</strong><span class="classifier">float, optional, default: 0.0</span></dt><dd><p>Stopping criterion for eigendecomposition of the Laplacian matrix
when using arpack eigen_solver.</p>
</dd>
<dt><strong>assign_labels</strong><span class="classifier">{‘kmeans’, ‘discretize’}, default: ‘kmeans’</span></dt><dd><p>The strategy to use to assign labels in the embedding
space.  There are two ways to assign labels after the laplacian
embedding.  k-means can be applied and is a popular choice. But it can
also be sensitive to initialization. Discretization is another
approach which is less sensitive to random initialization. See
the ‘Multiclass spectral clustering’ paper referenced below for
more details on the discretization approach.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>labels</strong><span class="classifier">array of integers, shape: n_samples</span></dt><dd><p>The labels of the clusters.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The graph should contain only one connect component, elsewhere
the results make little sense.</p>
<p>This algorithm solves the normalized cut for k=2: it is a
normalized spectral clustering.</p>
<p class="rubric">References</p>
<ul class="simple">
<li><p>Normalized cuts and image segmentation, 2000
Jianbo Shi, Jitendra Malik
<a class="reference external" href="http://citeseer.ist.psu.edu/viewdoc/summary?doi=10.1.1.160.2324">http://citeseer.ist.psu.edu/viewdoc/summary?doi=10.1.1.160.2324</a></p></li>
<li><p>A Tutorial on Spectral Clustering, 2007
Ulrike von Luxburg
<a class="reference external" href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.165.9323">http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.165.9323</a></p></li>
<li><p>Multiclass spectral clustering, 2003
Stella X. Yu, Jianbo Shi
<a class="reference external" href="http://www1.icsi.berkeley.edu/~stellayu/publication/doc/2003kwayICCV.pdf">http://www1.icsi.berkeley.edu/~stellayu/publication/doc/2003kwayICCV.pdf</a></p></li>
</ul>
</dd></dl>

<div class="section" id="examples-using-sklearn-cluster-spectral-clustering">
<h2>Examples using <code class="docutils literal notranslate"><span class="pre">sklearn.cluster.spectral_clustering</span></code><a class="headerlink" href="#examples-using-sklearn-cluster-spectral-clustering" title="Permalink to this headline">¶</a></h2>
<div class="sphx-glr-thumbcontainer" tooltip="This example uses :ref:`spectral_clustering` on a graph created from voxel-to-voxel difference ..."><div class="figure align-center" id="id1">
<img alt="../../../_images/sphx_glr_plot_coin_segmentation_thumb.png" src="../../../_images/sphx_glr_plot_coin_segmentation_thumb.png" />
<p class="caption"><span class="caption-text"><a class="reference internal" href="../../../auto_examples/cluster/plot_coin_segmentation/#sphx-glr-auto-examples-cluster-plot-coin-segmentation-py"><span class="std std-ref">Segmenting the picture of greek coins in regions</span></a></span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="In this example, an image with connected circles is generated and spectral clustering is used t..."><div class="figure align-center" id="id2">
<img alt="../../../_images/sphx_glr_plot_segmentation_toy_thumb.png" src="../../../_images/sphx_glr_plot_segmentation_toy_thumb.png" />
<p class="caption"><span class="caption-text"><a class="reference internal" href="../../../auto_examples/cluster/plot_segmentation_toy/#sphx-glr-auto-examples-cluster-plot-segmentation-toy-py"><span class="std std-ref">Spectral clustering for image segmentation</span></a></span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
</div><div class="clearer"></div></div>
</div>


          </div>
        </div>
      </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer">
        &copy; 2007 - 2019, scikit-learn developers (BSD License).
      <a href="../../../_sources/modules/generated/sklearn.cluster.spectral_clustering.rst.txt" rel="nofollow">Show this page source</a>
    </div>
     <div class="rel">
    
    <div class="buttonPrevious">
      <a href="../sklearn.cluster.mean_shift/">Previous
      </a>
    </div>
    <div class="buttonNext">
      <a href="../sklearn.cluster.ward_tree/">Next
      </a>
    </div>
    
     </div>

    
    <script>
        window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
        ga('create', 'UA-22606712-2', 'auto');
        ga('set', 'anonymizeIp', true);
        ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    
    <script>
      (function() {
        var cx = '016639176250731907682:tjtqbvtvij0';
        var gcse = document.createElement('script'); gcse.type = 'text/javascript'; gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(gcse, s);
      })();
    </script>
  </body>
</html>